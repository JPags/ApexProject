DatePickerControl.defaultFormat="MM/DD/YYYY";DatePickerControl.submitFormat="";DatePickerControl.offsetY=1;DatePickerControl.offsetX=0;DatePickerControl.todayText="Today";DatePickerControl.buttonTitle="Calendar...";DatePickerControl.buttonPosition="in";DatePickerControl.buttonOffsetX=0;DatePickerControl.buttonOffsetY=0;DatePickerControl.closeOnTodayBtn=true;DatePickerControl.defaultTodaySel=true;DatePickerControl.autoShow=false;DatePickerControl.firstWeekDay=0;DatePickerControl.weekend=[0,6];DatePickerControl.weekNumber=false;DatePickerControl.Months=["January","February","March","April","May","June","July","August","September","October","November","December"];DatePickerControl.Days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];DatePickerControl.useTrickyBG=false;if(navigator.userAgent.indexOf("MSIE")>1){DatePickerControl.useTrickyBG=true;DatePickerControl.offsetY=0;DatePickerControl.offsetX=-1;DatePickerControl.buttonOffsetX=-4;DatePickerControl.buttonOffsetY=0;if(document.getElementsByTagName("html")[0].getAttribute("xmlns")!=null){DatePickerControl.offsetY=16;DatePickerControl.offsetX=10;DatePickerControl.buttonOffsetX=8;DatePickerControl.buttonOffsetY=14}}DatePickerControl.editIdPrefix="DPC_";DatePickerControl.displayed=false;DatePickerControl.HIDE_TIMEOUT=200;DatePickerControl.hideTimeout=null;DatePickerControl.buttonIdPrefix="CALBUTTON";DatePickerControl.dayIdPrefix="CALDAY";DatePickerControl.currentDay=1;DatePickerControl.originalValue="";DatePickerControl.calFrameId="calendarframe";DatePickerControl.submitByKey=false;DatePickerControl.dayOfWeek=0;DatePickerControl.firstFocused=false;DatePickerControl.hideCauseBlur=false;DatePickerControl.onSubmitAsigned=false;DatePickerControl.minDate=null;DatePickerControl.maxDate=null;DatePickerControl.DOMonth=[31,28,31,30,31,30,31,31,30,31,30,31];DatePickerControl.lDOMonth=[31,29,31,30,31,30,31,31,30,31,30,31];function DatePickerControl(){}DatePickerControl.init=function(){if(!document.getElementById("CalendarPickerControl")){this.setGlobalParams();this.calBG=null;if(this.useTrickyBG){this.calBG=document.createElement("iframe");this.calBG.id="CalendarPickerControlBG";this.calBG.style.zIndex="49999";this.calBG.style.position="absolute";this.calBG.style.display="none";this.calBG.style.border="0px solid transparent";document.body.appendChild(this.calBG)}this.calContainer=document.createElement("div");this.calContainer.id="CalendarPickerControl";this.calContainer.style.zIndex="50000";this.calContainer.style.position="absolute";this.calContainer.style.display="none";document.body.appendChild(this.calContainer);if(this.calContainer.addEventListener){this.calContainer.addEventListener("click",DPC_onContainerClick,false);window.addEventListener("resize",DPC_onWindowResize,false)}else{if(this.calContainer.attachEvent){this.calContainer.attachEvent("onclick",DPC_onContainerClick);window.attachEvent("onresize",DPC_onWindowResize)}}}var a=document.getElementsByTagName("input");var d=a.length;for(i=0;i<d;i++){if(a[i].type.toLowerCase()=="text"){var e=a[i];var c=e.getAttribute("datepicker");var b=false;if(c!=null&&c=="true"){if(e.id){if(!this.createButton(e,false)){continue}b=true}else{alert("Attribute 'id' is mandatory for DatePickerControl.")}}else{if(e.id&&e.id.indexOf(this.editIdPrefix)==0){if(!this.createButton(e,true)){continue}b=true}}e.setAttribute("isdatepicker","true");if(b){if(e.addEventListener){e.addEventListener("keyup",DPC_onEditControlKeyUp,false);e.addEventListener("keydown",DPC_onEditControlKeyDown,false);e.addEventListener("keypress",DPC_onEditControlKeyPress,false);e.addEventListener("blur",DPC_onEditControlBlur,false);e.addEventListener("focus",DPC_onEditControlFocus,false);e.addEventListener("change",DPC_onEditControlChange,false)}else{if(e.attachEvent){e.attachEvent("onkeyup",DPC_onEditControlKeyUp);e.attachEvent("onkeydown",DPC_onEditControlKeyDown);e.attachEvent("onkeypress",DPC_onEditControlKeyPress);e.attachEvent("onblur",DPC_onEditControlBlur);e.attachEvent("onfocus",DPC_onEditControlFocus);e.attachEvent("onchange",DPC_onEditControlChange)}}var f=e.form;if(!this.onSubmitAsigned&&f){this.onSubmitAsigned=true;f.submitOrig=f.submit;f.submit=DPC_formSubmit;if(f.addEventListener){f.addEventListener("submit",DPC_onFormSubmit,false)}else{if(f.attachEvent){f.attachEvent("onsubmit",DPC_onFormSubmit)}}}}}}};DatePickerControl.setGlobalParams=function(){var obj=document.getElementById("DPC_DEFAULT_FORMAT");if(obj){this.defaultFormat=obj.value}obj=document.getElementById("DPC_SUBMIT_FORMAT");if(obj){this.submitFormat=obj.value}obj=document.getElementById("DPC_FIRST_WEEK_DAY");if(obj){this.firstWeekDay=(obj.value<0||obj.value>6)?0:parseInt(obj.value)}obj=document.getElementById("DPC_WEEKEND_DAYS");if(obj){eval("this.weekend = "+obj.value)}obj=document.getElementById("DPC_AUTO_SHOW");if(obj){this.autoShow=obj.value=="true"}obj=document.getElementById("DPC_DEFAULT_TODAY");if(obj){this.defaultTodaySel=obj.value=="true"}obj=document.getElementById("DPC_CALENDAR_OFFSET_X");if(obj){this.offsetX=parseInt(obj.value)}obj=document.getElementById("DPC_CALENDAR_OFFSET_Y");if(obj){this.offsetY=parseInt(obj.value)}obj=document.getElementById("DPC_TODAY_TEXT");if(obj){this.todayText=obj.value}obj=document.getElementById("DPC_BUTTON_TITLE");if(obj){this.buttonTitle=obj.value}obj=document.getElementById("DPC_BUTTON_POSITION");if(obj){this.buttonPosition=obj.value}obj=document.getElementById("DPC_BUTTON_OFFSET_X");if(obj){this.buttonOffsetX=parseInt(obj.value)}obj=document.getElementById("DPC_BUTTON_OFFSET_Y");if(obj){this.buttonOffsetY=parseInt(obj.value)}obj=document.getElementById("DPC_WEEK_NUMBER");if(obj){this.weekNumber=obj.value=="true"}obj=document.getElementById("DPC_MONTH_NAMES");if(obj){eval("this.Months = "+obj.value)}obj=document.getElementById("DPC_DAY_NAMES");if(obj){eval("this.Days = "+obj.value)}};function DPC_autoInit(){DatePickerControl.init()}if(window.addEventListener){window.addEventListener("load",DPC_autoInit,false)}else{if(window.attachEvent){window.attachEvent("onload",DPC_autoInit)}}DatePickerControl.createButton=function(l,a){var b=this.buttonIdPrefix+l.id;if(document.getElementById(b)){return false}var c="";if(a){var f=l.id.split("_");var o=f[f.length-1];if((o.indexOf("-")>0||o.indexOf("/")>0||o.indexOf(".")>0)&&o.indexOf("YY")>=0&&o.indexOf("D")>=0&&o.indexOf("M")>=0){c=o}else{c=this.defaultFormat}}else{c=l.getAttribute("datepicker_format");if(!c){c=this.defaultFormat}}l.setAttribute("datepicker_format",c);l.setAttribute("maxlength",c.length);l.setMinDate=function(p){this.setAttribute("datepicker_min",p)};l.setMaxDate=function(p){this.setAttribute("datepicker_max",p)};var e=document.createElement("img");e.id=b;e.title=this.buttonTitle;e.setAttribute("datepicker_inputid",l.id);e.setAttribute("datepicker_format",c);if(e.addEventListener){e.addEventListener("click",DPC_onButtonClick,false)}else{if(e.attachEvent){e.attachEvent("onclick",DPC_onButtonClick)}}e.className="calendarbutton";e.style.position="relative";e.style.cursor="pointer";e.style.verticalAlign="top";e.style.height=l.offsetHeight;e.src="calicon.png";if(this.buttonPosition=="in"){}var d=l.parentNode;var h=document.createElement("nobr");var g=document.createElement("span");g.innerHTML="&nbsp;";var n=null;if(l.nextSibling){n=l.nextSibling}d.removeChild(l);h.appendChild(l);h.appendChild(g);h.appendChild(e);h.appendChild(g.cloneNode(true));if(n){d.insertBefore(h,n)}else{d.appendChild(h)}return true};DatePickerControl.show=function(){if(!this.displayed){var a=this.inputControl;if(a==null){return}if(a.disabled){return}var d=getObject.getSize("offsetTop",a);var c=getObject.getSize("offsetLeft",a);var b=document.getElementById(this.calFrameId);this.calContainer.style.top=d+a.offsetHeight+this.offsetY+"px";this.calContainer.style.left=c+this.offsetX+"px";this.calContainer.style.display="none";this.calContainer.style.visibility="visible";this.calContainer.style.display="block";this.calContainer.style.height=b.offsetHeight;if(this.calBG){this.calBG.style.top=this.calContainer.style.top;this.calBG.style.left=this.calContainer.style.left;this.calBG.style.display="none";this.calBG.style.visibility="visible";this.calBG.style.display="block";this.calBG.style.width=this.calContainer.offsetWidth;if(b){this.calBG.style.height=b.offsetHeight}}this.displayed=true;a.focus()}};DatePickerControl.hide=function(){if(this.displayed){this.calContainer.style.visibility="hidden";this.calContainer.style.left=-1000;this.calContainer.style.top=-1000;if(this.calBG){this.calBG.style.visibility="hidden";this.calBG.style.left=-1000;this.calBG.style.top=-1000}this.inputControl.value=this.originalValue;this.displayed=false}};DatePickerControl.getMonthName=function(a){return this.Months[a]};DatePickerControl.getDaysOfMonth=function(b,a){if(this.isLeapYear(a)){return this.lDOMonth[b]}else{return this.DOMonth[b]}};DatePickerControl.calcMonthYear=function(b,a,d){var c=new Array();if(d==-1){if(b==0){c[0]=11;c[1]=parseInt(a)-1}else{c[0]=parseInt(b)-1;c[1]=parseInt(a)}}else{if(d==1){if(b==11){c[0]=0;c[1]=parseInt(a)+1}else{c[0]=parseInt(b)+1;c[1]=parseInt(a)}}}return c};DatePickerControl.getAllCode=function(){var a="";a+="<table class='calframe' id='"+this.calFrameId+"'>";a+=this.getHeaderCode();a+=this.getDaysHeaderCode();a+=this.getDaysCode();a+="</table>";return a};DatePickerControl.getHeaderCode=function(){var d=this.calcMonthYear(this.month,this.year,-1);var g=d[0];var l=d[1];var f=this.calcMonthYear(this.month,this.year,1);var h=f[0];var a=f[1];var c=new Date();var b="";var e=this.weekNumber?8:7;b+="<tr><td colspan='"+e+"' class='monthname'>";b+=this.monthName+"&nbsp;&nbsp;";b+="<span title='"+this.Months[this.month]+" "+(parseInt(this.year)-1)+"' class='yearbutton' ";b+="onclick='DatePickerControl.build("+this.month+", "+(parseInt(this.year)-1)+");return false;'>&laquo;</span>";b+="&nbsp;"+this.year+"&nbsp;";b+="<span title='"+this.Months[this.month]+" "+(parseInt(this.year)+1)+"' class='yearbutton' ";b+="onclick='DatePickerControl.build("+this.month+", "+(parseInt(this.year)+1)+");return false;'>&raquo;</span>";b+="</td></tr>";b+="<tr><td style='border-width:0px' colspan='"+e+"'>";b+="<table class='navigation' width='100%'><tr>";b+="<td class='navbutton' title='"+this.Months[g]+" "+l+"' ";b+="onclick='DatePickerControl.build("+g+", "+l+");return false;'>&lt;&lt;</td>";b+="<td class='navbutton' title='"+c.getDate()+" "+this.Months[c.getMonth()]+" "+c.getFullYear()+"' ";b+="onclick='DatePickerControl.build("+c.getMonth()+", "+c.getFullYear()+");DatePickerControl.selectToday();return false;'>";b+=this.todayText+"</td>";b+="<td class='navbutton' title='"+this.Months[h]+" "+a+"' ";b+="onclick='DatePickerControl.build("+h+", "+a+");return false;'>&gt;&gt;</td>";b+="</tr></table>";b+="</td></tr>";return b};DatePickerControl.getDaysHeaderCode=function(){var a="";a=a+"<tr>";if(this.weekNumber){a+="<td class='weeknumber'>&nbsp;</td>"}for(i=this.firstWeekDay;i<this.firstWeekDay+7;i++){a+="<td class='dayname' width='14%'>"+this.Days[i%7]+"</td>"}a=a+"</tr>";return a};DatePickerControl.getDaysCode=function(){var f=new Date();f.setDate(1);f.setMonth(this.month);f.setFullYear(this.year);var h=f.getDay();var l=1;var d=this.getDaysOfMonth(this.month,this.year);var e=0;var c="";this.dayOfWeek=h;var g=this.month==0?11:this.month-1;var b=this.prevm==11?this.year-1:this.year;prevmontdays=this.getDaysOfMonth(g,b);h=(h==0&&this.firstWeekDay)?7:h;if(this.weekNumber){var a=this.getWeekNumber(this.year,this.month,1)}c+="<tr>";if(this.weekNumber){c+="<td class='weeknumber'>"+a+"</td>"}for(i=this.firstWeekDay;i<h;i++){c=c+"<td class='dayothermonth'>"+(prevmontdays-h+i+1)+"</td>"}for(j=h-this.firstWeekDay;j<7;j++){if(this.isInRange(l)){classname=this.getDayClass(l,j);c+="<td class='"+classname+"' class_orig='"+classname+"' onClick='DatePickerControl.writeDate("+l+")' id='"+this.dayIdPrefix+l+"'>"+l+"</td>"}else{c+="<td class='dayothermonth'>"+l+"</td>"}l++}c=c+"</tr>";for(k=2;k<7;k++){c=c+"<tr>";if(this.weekNumber){a++;if(a>=53){a=1}c+="<td class='weeknumber'>"+a+"</td>"}for(j=0;j<7;j++){if(this.isInRange(l)){classname=this.getDayClass(l,j);c+="<td class='"+classname+"' class_orig='"+classname+"' onClick='DatePickerControl.writeDate("+l+")' id='"+this.dayIdPrefix+l+"'>"+l+"</td>"}else{c+="<td class='dayothermonth'>"+l+"</td>"}l++;if(l>d){e=1;break}}if(j==6){c+="</tr>"}if(e==1){break}}for(m=1;m<(7-j);m++){c+="<td class='dayothermonth'>"+m+"</td>"}return c};DatePickerControl.getDayClass=function(a,f){var g=new Date();var d=g.getDate();var c=g.getMonth();var b=g.getFullYear();if(a==d&&this.month==c&&this.year==b){return"today"}else{var e=(7+f+this.firstWeekDay)%7;for(i=0;i<this.weekend.length;i++){if(e==this.weekend[i]){return"weekend"}}return"day"}};DatePickerControl.formatData=function(c){var g;var f=1+this.month;f=(f.toString().length<2)?"0"+f:f;var h=this.getMonthName(this.month).substr(0,3).toUpperCase();var b=this.getMonthName(this.month).toUpperCase();var d=new String(this.year);var e=new String(this.year).substr(2,2);var a=(c.toString().length<2)?"0"+c:c;switch(this.format){case"MM/DD/YYYY":g=f+"/"+a+"/"+d;break;case"MM/DD/YY":g=f+"/"+a+"/"+e;break;case"MM-DD-YYYY":g=f+"-"+a+"-"+d;break;case"MM-DD-YY":g=f+"-"+a+"-"+e;break;case"YYYY-MM-DD":g=d+"-"+f+"-"+a;break;case"YYYY/MM/DD":g=d+"/"+f+"/"+a;break;case"DD/MON/YYYY":g=a+"/"+h+"/"+d;break;case"DD/MON/YY":g=a+"/"+h+"/"+e;break;case"DD-MON-YYYY":g=a+"-"+h+"-"+d;break;case"DD-MON-YY":g=a+"-"+h+"-"+e;break;case"DD/MONTH/YYYY":g=a+"/"+b+"/"+d;break;case"DD/MONTH/YY":g=a+"/"+b+"/"+e;break;case"DD-MONTH-YYYY":g=a+"-"+b+"-"+d;break;case"DD-MONTH-YY":g=a+"-"+b+"-"+e;break;case"DD/MM/YYYY":g=a+"/"+f+"/"+d;break;case"DD/MM/YY":g=a+"/"+f+"/"+e;break;case"DD-MM-YYYY":g=a+"-"+f+"-"+d;break;case"DD-MM-YY":g=a+"-"+f+"-"+e;break;case"DD.MM.YYYY":g=a+"."+f+"."+d;break;case"DD.MM.YY":g=a+"."+f+"."+e;break;default:g=f+"/"+a+"/"+d}return g};DatePickerControl.getDateFromControl=function(b){if(b==null){b=this.inputControl}var a=b.value;var c=b.getAttribute("datepicker_format");return this.getDateFromString(a,c.toString())};DatePickerControl.getDateFromString=function(f,e){var g=new Date();var a,d,b;if(f==""||e==""){return g}f=f.replace("/","@").replace("/","@");f=f.replace("-","@").replace("-","@");f=f.replace(".","@").replace(".","@");if(f.indexOf("/")>=0||f.indexOf("-")>=0||f.indexOf(".")>=0){return g}var c=f.split("@");if(c.length!=3){return g}for(i=0;i<3;i++){c[i]=parseFloat(c[i]);if(isNaN(c[i])){return g}}g.setDate(1);if(e.substring(0,1).toUpperCase()=="D"){g.setFullYear(this.yearTwo2Four(c[2]));g.setMonth(c[1]-1);g.setDate(c[0])}else{if(e.substring(0,1).toUpperCase()=="Y"){g.setFullYear(this.yearTwo2Four(c[0]));g.setMonth(c[1]-1);g.setDate(c[2])}else{if(e.substring(0,1).toUpperCase()=="M"){g.setFullYear(this.yearTwo2Four(c[2]));g.setMonth(c[0]-1);g.setDate(c[1])}}}return g};DatePickerControl.yearTwo2Four=function(a){if(a<99){if(a>=30){a+=1900}else{a+=2000}}return a};DatePickerControl.writeDate=function(a){var b=this.formatData(a);this.inputControl.value=b;this.originalValue=b;this.hide();if(DatePickerControl.onSelect){DatePickerControl.onSelect(this.inputControl.id)}this.firstFocused=true;this.inputControl.focus()};DatePickerControl.writeCurrentDate=function(){var a=this.formatData(this.currentDay);this.inputControl.value=a};DatePickerControl.build=function(a,g){var f=this.month;var e=this.year;var d=document.getElementById(this.calFrameId);if(a==null){var b=new Date();this.month=b.getMonth();this.year=b.getFullYear()}else{this.month=a;this.year=g}if(!this.isInRange(null)){this.month=f;this.year=e}if(!this.isInRange(this.currentDay)){if(this.minDate&&this.currentDay<this.minDate.getDate()){this.currentDay=this.minDate.getDate()}if(this.maxDate&&this.currentDay>this.maxDate.getDate()){this.currentDay=this.maxDate.getDate()}}this.monthName=this.Months[this.month];var c=this.getAllCode();writeLayer(this.calContainer.id,null,c);if(this.calContainer&&d){this.calContainer.style.height=d.offsetHeight}this.firstFocused=true;this.inputControl.focus();this.selectDay(this.currentDay)};DatePickerControl.buildPrev=function(){if(!this.displayed){return}var b=this.calcMonthYear(this.month,this.year,-1);var c=b[0];var a=b[1];this.build(c,a)};DatePickerControl.buildNext=function(){if(!this.displayed){return}var b=this.calcMonthYear(this.month,this.year,1);var c=b[0];var a=b[1];this.build(c,a)};DatePickerControl.selectToday=function(){var b=new Date();var a=b.getDate();if(!this.isInRange(a)){return}if(this.closeOnTodayBtn){this.currentDay=a;this.writeDate(this.currentDay)}else{this.selectDay(a)}};DatePickerControl.selectDay=function(c){if(!this.displayed){return}if(!this.isInRange(c)){return}var e=this.currentDay;var a=this.getDaysOfMonth(this.month,this.year);if(c>a){return}var b=document.getElementById(this.dayIdPrefix+c);var d=document.getElementById(this.dayIdPrefix+this.currentDay);if(d){d.className=d.getAttribute("class_orig")}if(b){b.className="current";this.currentDay=c;this.writeCurrentDate()}};DatePickerControl.selectPrevDay=function(c){if(!this.displayed){return}var d=this.currentDay;var a=this.getDaysOfMonth(this.month,this.year);var b=d-c;if(b<=0){if(c==7){d=(d+this.dayOfWeek)+28-this.dayOfWeek;d--;b=d>a?d-7:d}else{b=a}}this.selectDay(b)};DatePickerControl.selectNextDay=function(d){if(!this.displayed){return}var c=this.currentDay;var a=this.getDaysOfMonth(this.month,this.year);var b=c+d;if(b>a){if(d==7){c=((c+this.dayOfWeek)%7)-this.dayOfWeek;b=c<0?c+7:c;b++}else{b=1}}this.selectDay(b)};DatePickerControl.showForEdit=function(b){if(this.displayed){return}if(b==null){return}if(b.disabled){return}this.inputControl=b;this.originalValue=b.value;this.setupRange();var d=this.inputControl.getAttribute("datepicker_format");if(d==null){d=this.defaultFormat}this.format=d;if(this.validate(b.value,d)){var a=this.getDateFromControl();this.currentDate=a;this.build(a.getMonth(),a.getFullYear());this.currentDay=a.getDate()}else{b.value="";this.originalValue="";this.currentDate=null;if(this.defaultTodaySel){this.currentDay=new Date().getDate()}else{this.currentDay=1}this.build(null,null)}var c=document.getElementById(this.dayIdPrefix+this.currentDay);if(c){c.className="current"}this.writeCurrentDate();this.show()};DatePickerControl.isInRange=function(b){if(!this.minDate&&!this.maxDate){return true}if(b){var f=new Date();f.setFullYear(this.year);f.setMonth(this.month);f.setDate(b);if(this.minDate){if(this.compareDates(f,this.minDate)<0){return false}}if(this.maxDate){if(this.compareDates(f,this.maxDate)>0){return false}}}else{var e=parseInt(this.year.toString()+(this.month<10?"0"+this.month.toString():this.month.toString()));var a;if(this.minDate){a=this.minDate.getMonth();var d=parseInt(this.minDate.getFullYear().toString()+(a<10?"0"+a.toString():a.toString()));if(e<d){return false}}if(this.maxDate){a=this.maxDate.getMonth();var c=parseInt(this.maxDate.getFullYear().toString()+(a<10?"0"+a.toString():a.toString()));if(e>c){return false}}}return true};DatePickerControl.setupRange=function(){var d=this.inputControl;var e=d.getAttribute("datepicker_format");var c=d.getAttribute("datepicker_min");this.minDate=c?this.getDateFromString(c,e):null;var a=d.getAttribute("datepicker_max");this.maxDate=a?this.getDateFromString(a,e):null;if(this.maxDate&&this.minDate){if(this.maxDate.getTime()<this.minDate.getTime()){var b=this.maxDate;this.maxDate=this.minDate;this.minDate=b}}};DatePickerControl.compareDates=function(h,g){var a=h.getMonth();var l=h.getDate();var e=h.getFullYear().toString()+(a<10?"0"+a.toString():a.toString())+(l<10?"0"+l.toString():l.toString());a=g.getMonth();l=g.getDate();var b=g.getFullYear().toString()+(a<10?"0"+a.toString():a.toString())+(l<10?"0"+l.toString():l.toString());var f=parseInt(e);var c=parseInt(b);return f-c};DatePickerControl.validate=function(f,p){var q;var g;var n,e,o;var a=this.currentDay,l=this.month,b=this.year;if(f==""){return false}if(p.substring(0,1).toUpperCase()=="D"){q=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/}else{if(p.substring(0,1).toUpperCase()=="Y"){q=/^\d{2,4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/}else{if(p.substring(0,1).toUpperCase()=="M"){q=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/}}}if(!q.test(f)){return false}g=(f.indexOf("/")>1)?"/":((f.indexOf("-")>1)?"-":".");var c=f.split(g);if(p.substring(0,1).toUpperCase()=="D"){n=parseFloat(c[0]);e=parseFloat(c[1]);o=parseFloat(c[2])}else{if(p.substring(0,1).toUpperCase()=="Y"){n=parseFloat(c[2]);e=parseFloat(c[1]);o=parseFloat(c[0])}else{if(p.substring(0,1).toUpperCase()=="M"){n=parseFloat(c[1]);e=parseFloat(c[0]);o=parseFloat(c[2])}}}if(e<1||e>12){return false}if(n>this.getDaysOfMonth(e-1,o)){return false}this.month=e;this.year=o;var h=this.isInRange(n);this.month=l;this.year=b;return h};DatePickerControl.isLeapYear=function(a){if((a%4)==0){if((a%100)==0&&(a%400)!=0){return false}return true}return false};function DPC_onButtonClick(a){DatePickerControl.onButtonClick(a)}DatePickerControl.onButtonClick=function(c){if(!this.displayed){if(c==null){c=window.event}var b=(c.srcElement)?c.srcElement:c.originalTarget;var a=document.getElementById(b.getAttribute("datepicker_inputid"));this.showForEdit(a)}else{this.hide()}};function DPC_onContainerClick(a){DatePickerControl.onContainerClick(a)}DatePickerControl.onContainerClick=function(a){if(a==null){a=window.event}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}this.inputControl.focus();return false};function DPC_onEditControlKeyUp(a){DatePickerControl.onEditControlKeyUp(a)}DatePickerControl.onEditControlKeyUp=function(c){if(c==null){c=window.event}var b=c.srcElement?c.srcElement:c.originalTarget;var a=c.charCode?c.charCode:c.which?c.which:c.keyCode;switch(a){case 37:this.selectPrevDay(1);break;case 38:this.selectPrevDay(7);break;case 39:this.selectNextDay(1);break;case 40:if(!this.displayed){this.showForEdit(b)}else{this.selectNextDay(7);break}break;case 27:this.hide();break;case 33:if((c.modifiers&Event.SHIFT_MASK)||(c.shiftKey)){this.build(this.month,parseInt(this.year)-1)}else{this.buildPrev()}break;case 34:if((c.modifiers&Event.SHIFT_MASK)||(c.shiftKey)){this.build(this.month,parseInt(this.year)+1)}else{this.buildNext()}break;case 13:if(this.displayed&&this.currentDay>0&&this.submitByKey){this.writeDate(this.currentDay)}break}return false};function DPC_onEditControlKeyDown(a){DatePickerControl.onEditControlKeyDown(a)}DatePickerControl.onEditControlKeyDown=function(c){if(c==null){c=window.event}var b=c.srcElement?c.srcElement:c.originalTarget;var a=c.charCode?c.charCode:c.which?c.which:c.keyCode;if(a>=65&&a<=90){if(c.stopPropagation){c.stopPropagation()}if(c.preventDefault){c.preventDefault()}c.returnValue=false;c.cancelBubble=true;return false}switch(a){case 13:this.submitByKey=true;break;case 9:case 32:if(this.displayed&&this.currentDay>0){this.writeDate(this.currentDay)}break}};function DPC_onEditControlKeyPress(a){DatePickerControl.onEditControlKeyPress(a)}DatePickerControl.onEditControlKeyPress=function(c){if(c==null){c=window.event}var b=c.srcElement?c.srcElement:c.originalTarget;var a=c.charCode?c.charCode:c.which?c.which:c.keyCode;if(!((a<32)||(a>44&&a<58))){if(c.stopPropagation){c.stopPropagation()}if(c.preventDefault){c.preventDefault()}c.returnValue=false;c.cancelBubble=true;return false}};function DPC_onEditControlBlur(a){DatePickerControl.onEditControlBlur(a)}DatePickerControl.onEditControlBlur=function(a){if(a==null){a=window.event}if(!this.hideTimeout){this.hideTimeout=setTimeout("DatePickerControl.hide()",this.HIDE_TIMEOUT)}this.firstFocused=false;this.hideCauseBlur=true};function DPC_onEditControlChange(a){DatePickerControl.onEditControlChange(a)}DatePickerControl.onEditControlChange=function(b){if(b==null){b=window.event}var a=(b.srcElement)?b.srcElement:b.originalTarget;if(a.value==""){return}var c=a.getAttribute("datepicker_format");if(!this.validate(a.value,c)){setTimeout("e = document.getElementById('"+a.id+"'); e.value=''; e.focus()",10)}};function DPC_onEditControlFocus(a){DatePickerControl.onEditControlFocus(a)}DatePickerControl.onEditControlFocus=function(b){if(b==null){b=window.event}var a=(b.srcElement)?b.srcElement:b.originalTarget;this.inputControl=a;this.originalValue=a.value;this.setupRange();if((!this.displayed||this.hideCauseBlur)&&this.autoShow&&!this.firstFocused){clearTimeout(this.hideTimeout);this.hideTimeout=null;this.firstFocused=true;if(this.hideCauseBlur){this.hideCauseBlur=false;this.hide()}this.showForEdit(a)}else{if(this.inputControl&&this.inputControl.id!=a.id){this.hide()}else{if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}}}};function DPC_onFormSubmit(a){DatePickerControl.onFormSubmit(a)}DatePickerControl.onFormSubmit=function(a){if(this.submitByKey){this.submitByKey=false;if(this.displayed&&this.currentDay>0){this.writeDate(this.currentDay);if(a==null){a=window.event}var b=(a.srcElement)?a.srcElement:a.originalTarget;if(a.stopPropagation){a.stopPropagation()}if(a.preventDefault){a.preventDefault()}a.returnValue=false;a.cancelBubble=true;return false}}this.reformatOnSubmit()};DatePickerControl.reformatOnSubmit=function(){if(this.submitFormat==""){return true}var a=document.getElementsByTagName("input");var e=a.length;var c;for(c=0;c<e;c++){if(a[c].type.toLowerCase()=="text"){var f=a[c];if(f.value==""){continue}var g=f.getAttribute("isdatepicker");if(g&&g=="true"){var h=this.getDateFromControl(f);var b=this.submitFormat.replace("DD",h.getDate());var d=h.getMonth()+1;b=b.replace("MM",d.toString());if(this.submitFormat.indexOf("YYYY")>=0){b=b.replace("YYYY",h.getFullYear())}else{b=b.replace("YY",h.getFullYear())}f.value=b}}}return true};function DPC_formSubmit(){var a=DatePickerControl.reformatOnSubmit();if(this.submitOrig){a=this.submitOrig()}return a}function DPC_onWindowResize(a){DatePickerControl.onWindowResize(a)}DatePickerControl.onWindowResize=function(a){this.relocate()};DatePickerControl.relocateButtons=function(){return;var e=document.getElementsByTagName("div");for(key in e){if(e[key].id&&e[key].id.indexOf(this.buttonIdPrefix)==0){var c=e[key];if(c.style.display=="none"){continue}var a=document.getElementById(c.getAttribute("datepicker_inputid"));if(a.style.display=="none"||a.offsetTop==0){continue}var b=getObject.getSize("offsetTop",a);var d=getObject.getSize("offsetLeft",a);c.style.top=(b+Math.floor((a.offsetHeight-c.offsetHeight)/2)+this.buttonOffsetY)+"px";var f=Math.floor((a.offsetHeight-c.offsetHeight)/2);if(this.buttonPosition=="in"){c.style.left=(d+a.offsetWidth-c.offsetWidth-f+this.buttonOffsetX)+"px"}else{c.style.left=(d+a.offsetWidth+f+this.buttonOffsetX)+"px"}}}};DatePickerControl.relocate=function(){if(this.displayed){var a=this.inputControl;if(a==null){return}var c=getObject.getSize("offsetTop",a);var b=getObject.getSize("offsetLeft",a);this.calContainer.style.top=c+a.offsetHeight+this.offsetY+"px";this.calContainer.style.left=b+this.offsetX+"px";if(this.calBG){this.calBG.style.top=this.calContainer.style.top;this.calBG.style.left=this.calContainer.style.left}}};DatePickerControl.getWeekNumber=function(h,f,n){var g=new Date(h,f,n);var c=new Date(h,0,1);var e=7+1-c.getDay();if(e==8){e=1}var b=((Date.UTC(y2k(h),g.getMonth(),g.getDate(),0,0,0)-Date.UTC(y2k(h),0,1,0,0,0))/1000/60/60/24)+1;var d=Math.floor((b-e+7)/7);if(d==0){h--;var a=new Date(h,0,1);var l=7+1-a.getDay();if(l==2||l==8){d=53}else{d=52}}return d};function y2k(a){return(a<1000)?a+1900:a}function getObject(a){if(bw.dom){this.hElement=document.getElementById(a);this.hStyle=this.hElement.style}else{if(bw.ns4){this.hElement=document.layers[a];this.hStyle=this.hElement}else{if(bw.ie){this.hElement=document.all[a];this.hStyle=this.hElement.style}}}}getObject.getSize=function(sParam,hLayer){nPos=0;while((hLayer.tagName)&&!(/(body|html)/i.test(hLayer.tagName))){nPos+=eval("hLayer."+sParam);if(sParam=="offsetTop"){if(hLayer.clientTop){nPos+=hLayer.clientTop}}if(sParam=="offsetLeft"){if(hLayer.clientLeft){nPos+=hLayer.clientLeft}}hLayer=hLayer.offsetParent}return nPos};function writeLayer(ID,parentID,sText){if(document.layers){var oLayer;if(parentID){oLayer=eval("document."+parentID+".document."+ID+".document")}else{oLayer=document.layers[ID].document}oLayer.open();oLayer.write(sText);oLayer.close()}else{if(document.all){document.all[ID].innerHTML=sText}else{document.getElementById(ID).innerHTML=sText}}};